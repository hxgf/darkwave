<label class="form-label">Avatar</label>

<!-- fixit cleanup & move to a component -->

<!-- v5 -->
<script src="/js/lib/dropzone.min.js"></script>
<link rel="stylesheet" href="/css/lib/dropzone.min.css" type="text/css" />
<link rel="stylesheet" href="/css/lib/tabler-vendors.min.css" type="text/css" />

<!-- v6 -->
<!-- <script src="https://unpkg.com/dropzone@6.0.0-beta.1/dist/dropzone-min.js"></script> -->
<!-- <link href="https://unpkg.com/dropzone@6.0.0-beta.1/dist/dropzone.css" rel="stylesheet" type="text/css" /> -->

<style>
  .upload-delete{
    display: none;
    opacity: 0.8;
  }
  .upload-delete:hover{
    opacity: 1;
  }
  .preview-image:hover img {
    opacity: .5;
  }
  .preview-image:hover .upload-delete{
    display: block;
  }
</style>

<div class="mb-3" data-dz-upload="avatar">
  <div class="preview-image position-relative w-75">
    {{#if data.avatar_medium}}
    <img class="rounded-2 border shadow-sm" src="{{data.avatar_medium}}" />
    <div class="upload-delete position-absolute top-0 end-0">      
      <span onclick="dw.photo_upload_delete('avatar', {'confirm': true, 'message': `Replace current avatar?`})" class="d-block cursor-pointer p-3">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="text-danger bi bi-x-circle-fill" viewBox="0 0 16 16">
          <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
        </svg>
      </span>
    </div>
    {{/if}}
  </div>
  <div class="dropzone rounded" {{#if data.avatar_medium}}style="display: none;"{{/if}}>
    <div class="dz-message">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M12 5l0 14"></path>
        <path d="M5 12l14 0"></path>
      </svg>
      <div class="dropzone-msg-desc mt-3">Drag photo here to upload</div>
    </div>
  </div>
</div>

<script>
  Dropzone.autoDiscover = false;
  dw.photo_upload_initialize('avatar', {
    'preview_class_extra': 'rounded-2 border shadow-sm'
  });
</script>